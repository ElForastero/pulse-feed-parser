<p>With more and more users spending most of their time in the browser, richly interactive websites, games, remote
  desktop streaming, and application streaming strive to provide an immersive, full screen experience. To accomplish
  this, sites need access to special keys and keyboard shortcuts while they are in full screen mode, so that they can be
  used for navigation, menus, or gaming functionality. Some examples of the keys that may be required are <kbd>Esc</kbd>,
  <kbd>Alt</kbd> + <kbd>Tab</kbd>, <kbd>Cmd</kbd> + <kbd>`</kbd>, and <kbd>Ctrl</kbd> + <kbd>N</kbd>.</p> <p>By default,
  these keys are not available to the web application because they are captured by the browser or the underlying
  operating system. The Keyboard Lock API enables websites to use all available keys allowed by the host OS (see <a
    href="#browser-compatibility">Browser compatibility</a>).</p>
<figure class="w-figure"><img class="w-screenshot w-screenshot--filled"
                              src="https://web.dev/keyboard-lock/chrome-remote-desktop.png"
                              alt="Ubuntu Linux streamed to a browser tab in macOS Chrome (not running in full screen mode yet).">
  <figcaption> The problem: a streamed Ubuntu Linux remote desktop <em>not</em> running in full screen mode and <em>without</em>
    active keyboard lock, so system keys are still captured by the macOS host operating system and the experience is
    <em>not</em> immersive yet.
  </figcaption>
</figure> <h2 id="using-the-keyboard-lock-api">Using the Keyboard Lock API <a class="w-headline-link"
                                                                              href="#using-the-keyboard-lock-api"
                                                                              aria-hidden="true">#</a></h2> <p>The <a
  href="https://developer.mozilla.org/en-US/docs/Web/API/Keyboard"><code>Keyboard</code> interface</a> of the the
  Keyboard API provides functions that toggle capturing of key presses from the physical keyboard as well as getting
  information about the used <a href="https://developer.mozilla.org/en-US/docs/Web/API/Keyboard/getLayoutMap">keyboard
    layout</a>.</p> <h3 id="prerequisite">Prerequisite <a class="w-headline-link" href="#prerequisite"
                                                          aria-hidden="true">#</a></h3> <p>There are two different types
  of full screen available in modern browsers: JavaScript-initiated via the <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API">Fullscreen API</a> and user-initiated via a
  keyboard shortcut. The Keyboard Lock API is only available when <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen">JavaScript-initiated full
    screen</a> is active. Here's an example of JavaScript-initiated full screen:</p>
<div>
  <pre class="language-js"><code class="language-js"><span class="token keyword">await</span> document<span
    class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span
    class="token function">requestFullscreen</span><span class="token punctuation">(</span><span
    class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div><h3 id="browser-compatibility">Browser compatibility <a class="w-headline-link" href="#browser-compatibility"
                                                              aria-hidden="true">#</a></h3> <p>You can see browser
  compatibility on <a href="https://caniuse.com/#feat=mdn-api_keyboard_lock">Can I use</a>. Note that not all system
  keys can be locked. This varies from operating system to operating system. For example, follow <a
    href="https://crbug.com/855738">crbug.com/855738</a> for progress updates on system keyboard lock for macOS.</p> <h3
  id="feature-detection">Feature detection <a class="w-headline-link" href="#feature-detection" aria-hidden="true">#</a>
</h3> <p>You can use the following pattern to check if the Keyboard Lock API is supported:</p>
<div>
  <pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span
    class="token punctuation">(</span><span class="token string">'keyboard'</span> <span class="token keyword">in</span> navigator <span
    class="token operator">&amp;&amp;</span> <span class="token string">'lock'</span> <span
    class="token keyword">in</span> navigator<span class="token punctuation">.</span>keyboard<span
    class="token punctuation">)</span> <span class="token punctuation">{</span><br> <span class="token comment">// Supported!</span><br><span
    class="token punctuation">}</span></code></pre>
</div><h3 id="locking-the-keyboard">Locking the keyboard <a class="w-headline-link" href="#locking-the-keyboard"
                                                            aria-hidden="true">#</a></h3> <p>The <a
  href="https://developer.mozilla.org/en-US/docs/Web/API/Keyboard/lock"><code>lock()</code></a> method of the <code>Keyboard</code>
  interface returns a promise after enabling the capture of key presses for any or all of the keys on the physical
  keyboard. This method can only capture keys that are granted access by the underlying operating system. The <code>lock()</code>
  method takes an array of one or more key codes to lock. If no key codes are provided, all keys will be locked. A list
  of valid key code values is available in the <a href="https://www.w3.org/TR/uievents-code/#keyboard-key-codes">UI
    Events KeyboardEvent code Values</a> spec.</p> <h4 id="capturing-all-keys">Capturing all keys <a
  class="w-headline-link" href="#capturing-all-keys" aria-hidden="true">#</a></h4> <p>The following example captures all
  key presses.</p>
<div>
  <pre class="language-js"><code class="language-js">navigator<span class="token punctuation">.</span>keyboard<span
    class="token punctuation">.</span><span class="token function">lock</span><span
    class="token punctuation">(</span><span class="token punctuation">)</span><span
    class="token punctuation">;</span></code></pre>
</div><h4 id="capturing-specific-keys">Capturing specific keys <a class="w-headline-link"
                                                                  href="#capturing-specific-keys"
                                                                  aria-hidden="true">#</a></h4> <p>The following example
  captures the <kbd>W</kbd>, <kbd>A</kbd>, <kbd>S</kbd>, and <kbd>D</kbd> keys. It captures these keys regardless of
  which modifiers are used with the key press. Assuming a US QWERTY layout, registering <code>&quot;KeyW&quot;</code>
  ensures that <kbd>W</kbd>, <kbd>Shift</kbd> + <kbd>W</kbd>, <kbd>Control</kbd> + <kbd>W</kbd>, <kbd>Control</kbd> +
  <kbd>Shift</kbd> + <kbd>W</kbd>, and all other key modifier combinations with <kbd>W</kbd> are sent to the app. The
  same applies to <code>&quot;KeyA&quot;</code>, <code>&quot;KeyS&quot;</code>, and <code>&quot;KeyD&quot;</code>.</p>
<div>
  <pre class="language-js"><code class="language-js"><span class="token keyword">await</span> navigator<span
    class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span
    class="token function">lock</span><span class="token punctuation">(</span><span
    class="token punctuation">[</span><br> <span class="token string">"KeyW"</span><span
    class="token punctuation">,</span><br> <span class="token string">"KeyA"</span><span
    class="token punctuation">,</span><br> <span class="token string">"KeyS"</span><span
    class="token punctuation">,</span><br> <span class="token string">"KeyD"</span><span
    class="token punctuation">,</span><br><span class="token punctuation">]</span><span
    class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div><p>You can respond to captured key presses using keyboard events. For example this code uses the
  <code>onkeydown</code> event:</p>
<div>
  <pre class="language-js"><code class="language-js">document<span class="token punctuation">.</span><span
    class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span
    class="token punctuation">,</span> <span class="token punctuation">(</span><span
    class="token parameter">e</span><span class="token punctuation">)</span> <span
    class="token operator">=></span> <span class="token punctuation">{</span><br> <span class="token keyword">if</span> <span
    class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>code <span
    class="token operator">===</span> <span class="token string">'KeyA'</span><span
    class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span
    class="token operator">!</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>ctrlKey <span
    class="token operator">||</span> event<span class="token punctuation">.</span>metaKey<span
    class="token punctuation">)</span><span class="token punctuation">)</span> <span
    class="token punctuation">{</span><br> <span class="token comment">// Do something when the 'A' key was pressed, but only</span><br> <span
    class="token comment">// when not in combination with the command or control key.</span><br> <span
    class="token punctuation">}</span><br><span class="token punctuation">}</span><span
    class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div><h3 id="unlocking-the-keyboard">Unlocking the keyboard <a class="w-headline-link" href="#unlocking-the-keyboard"
                                                                aria-hidden="true">#</a></h3> <p>The <a
  href="https://developer.mozilla.org/en-US/docs/Web/API/Keyboard/unlock"><code>unlock()</code></a> method unlocks all
  keys captured by the <code>lock()</code> method and returns synchronously.</p>
<div>
  <pre class="language-js"><code class="language-js">navigator<span class="token punctuation">.</span>keyboard<span
    class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span
    class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div><p>When a document is closed, the browser always implicitly calls <code>unlock()</code>.</p> <h2 id="demo">Demo <a
  class="w-headline-link" href="#demo" aria-hidden="true">#</a></h2> <p>You can test the Keyboard Lock API by running
  the <a href="https://keyboard-lock.glitch.me/">demo</a> on Glitch. Be sure to <a
    href="https://glitch.com/edit/#!/keyboard-lock">check out the source code</a>. Clicking the Enter full screen button
  below launches the demo in a new window so it can enter full screen mode.</p>
<div class="glitch-embed-wrap" style="height: 420px; width: 100%;">
  <iframe allow="camera; clipboard; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi; vr"
          loading="lazy"
          src="https://glitch.com/embed/#!/embed/keyboard-lock?attributionHidden=true&sidebarCollapsed=true&path=script.js&previewSize=100"
          style="height: 100%; width: 100%; border: 0;" title="keyboard-lock on Glitch"></iframe>
</div> <h2 id="security-considerations">Security Considerations <a class="w-headline-link"
                                                                   href="#security-considerations"
                                                                   aria-hidden="true">#</a></h2> <p>One concern with
  this API is that it could be used to grab all of the keys and (in conjunction with the <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API">Fullscreen API</a> and the <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/Pointer_Lock_API">PointerLock API</a>) prevent the user from
  exiting the web page. To prevent this, the spec requires the browser to provide a way for the user to exit from
  keyboard lock even if all of the keys are requested by the API. In Chrome, this escape hatch is a long (two second)
  <kbd>Esc</kbd> key press to trigger an exit from Keyboard Lock.</p> <h2 id="helpful-links">Helpful links <a
  class="w-headline-link" href="#helpful-links" aria-hidden="true">#</a></h2>
<ul>
  <li><a href="https://wicg.github.io/keyboard-lock/">Specification draft</a></li>
  <li><a href="https://github.com/WICG/keyboard-lock">GitHub repository</a></li>
  <li><a href="https://chromestatus.com/features/5642959835889664">ChromeStatus entry</a></li>
  <li><a href="https://crbug.com/677559">Chrome tracking bug</a></li>
  <li><a href="https://www.w3.org/TR/uievents-code/#keyboard-key-codes">Key codes for standard keyboards</a></li>
</ul> <h2 id="acknowledgements">Acknowledgements <a class="w-headline-link" href="#acknowledgements" aria-hidden="true">#</a>
</h2> <p>This article was reviewed by <a href="https://github.com/jpmedley">Joe Medley</a> and <a
  href="https://github.com/kaycebasques">Kayce Basques</a>. The Keyboard Lock spec is authored by <a
  href="https://www.linkedin.com/in/garykac">Gary Kacmarcik</a> and <a
  href="https://www.linkedin.com/in/jamie-walch-395b332b">Jamie Walch</a>. Hero image by <a
  href="https://unsplash.com/@kensuarez">Ken Suarez</a> on <a href="https://unsplash.com/s/photos/padlock-computer">Unsplash</a>.
</p>
